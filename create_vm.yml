---
- name: create vm from a template
  hosts: localhost
  become: false
  gather_facts: false
  tasks:
    - name: create VM
      community.vmware.vmware_guest:
        hostname: "192.168.0.240"
        username: "administrator@vsphere.local"
        password: "Mildred!274"
        validate_certs: "{{ vcenter_validate_certs }}"
        datacenter: "Datacenter"
        cluster: "{{ vcenter_cluster }}"
        template: "{{ vm_template }}"
        name: "Test01"
        folder: "ansible"
        state: "present"

    - name: Gather guest info
      vmware.vmware.guest_info:
        validate_certs: false
        hostname: "192.168.0.240"
        username: "administrator@vsphere.local"
        password: "Mildred!274"
        guest_name: "Test01"
